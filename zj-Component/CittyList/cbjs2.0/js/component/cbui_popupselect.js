console.log("def:component_popupselect"),define(["cbui_core","component/cbui_popupwindow","css!@/../../css/cbui_popupselect.css"],function(a){var b=a.Fn,c=a.Component,d=a.Template,e=b.$;d.PopupSelect={content:function(a){return _.template("<%if(data."+a.value+">-1){%><%=data."+a.data+"[data."+a.value+"]."+a.title+"%><%}else{%><%=data.text%><%}%>",d.outerSettings)},popupWindow:function(a){return _.template('<div class="popupselect-popup"><%for(var i=0,n=data.'+a.data+'.length;i<n;i++){%><input class="popupselect-item" type="button" value="<%=data.'+a.data+"[i]."+a.title+'%>" data-select-item="<%=i%>"/><%}%><%if(data.showCancel){%><input class="popupselect-item" type="button" value="<%=data.cancelText%>" data-select-item/><%}%></div>',d.outerSettings)}};var f=c.PopupWindow.extend({initialize:function(a){this._super(a);var b=this;this.bindEvent("click [data-select-item]",function(a){var c=e(a.currentTarget).data("select-item");b.close(""===c?void 0:c)})},getExData:function(a){return this.parent.getExData(a)}});c.PopupSelect=c.Base.extend({initialize:function(a){this._super(a);var c=this,e=this.model,g=e.mapping=b.getTypeVal("Object",e.mapping,{});g.value=b.getTypeVal("String",g.value,"selected"),g.data=b.getTypeVal("String",g.items,"items"),g.title=b.getTypeVal("String",g.title,"title"),this.template=d.obtainTemplate(this.template,d.PopupSelect.content(g)),this.bindEvent("click",function(){c.isBadClick()||"ready"===c.model.getStatus()&&new f({parent:c,onResult:function(a){c.setValue(a),c.model.proxy&&c.render()},onCancel:c.onCancel,onShow:c.onShow,onClose:c.onClose,template:d.obtainTemplate(c.$el.data("template-popup"),d.PopupSelect.popupWindow(g))}).show()}),e.exCfg={text:b.getTypeVal("String",this.$el.attr("data-text"),"请选择..."),showCancel:this.$el.data("show-cancel")===!0,cancelText:b.getTypeVal("String",this.$el.attr("data-cancel-text"),"取消")},b.bindFunctions(this,"onSelectChange","onCancel"),this.model.on("change",function(){if(_.isFunction(c.onSelectChange)){var a=c.model,b=a.getData();if(_.isArray(b)){var d=a.getValue();_.isObject(b[d])&&c.onSelectChange(b[d],d)}}})},getExData:function(a){return this.model.exCfg},reset:function(){this.setValue(-1)},getValue:function(){var a=this.model.getData();return _.isArray(a)&&this.model.getValue()>-1?a[this.model.getValue()]:null},setSelect:function(a){for(var b=!1,c=this.model.getData(),d=0;d<c.length;d++){for(var e in a){if(a[e]!=c[d][e]){b=!1;break}b=!0}if(b)return this.setValue(d),void 0}}})});